--- 1. Вывод успешных заказов (т.е. заказов со статусом "получен") дороже 1000 за ноябрь 2021 
--- с выводом имени и e-mail клиента, локации магазина и статуса заказа
---
SELECT id AS order,
	(SELECT customer_name FROM customers WHERE id = orders.customer_id) AS customer,
	(SELECT customer_email FROM customers WHERE id = orders.customer_id) AS customer_email,
	(SELECT point_city FROM points WHERE points.id = orders.point_id) AS point,
	amount_total,
	(SELECT order_status FROM orders_statuses WHERE order_status_id = orders_statuses.id) AS order_status,
	order_status_changed_at
	FROM orders
	WHERE amount_total >= 1000 
	AND order_status_id = 7 
	AND order_status_changed_at >= '2021-11-01*'
	AND order_status_changed_at <= '2021-11-30*'
	ORDER BY customer_id, amount_total;
---
---
--- 2. Вывод магазинов в которых активные к продаже товары есть в остатках (количество товаров меньше 10)
--- с выводом города и кода магазина, а также кода и количества товара
---
SELECT point_id AS point,
	(SELECT point_city FROM points WHERE points.id = points_products.point_id) AS city,
	product_id,
	(SELECT product_name FROM products WHERE products.id = points_products.product_id) AS product,
	is_active AS product_state,
	product_amount
	FROM points_products
	WHERE is_active = true AND product_amount <= 10
	ORDER BY point_id;




